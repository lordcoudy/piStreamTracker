# piStreamTracker Configuration
# All settings in one place for easy customization
#
# Architecture:
#   Pi 3B+ (Camera)  ──MJPEG via Ethernet──►  Pi 5 (Tracker + EV3)
#   192.168.100.1                              192.168.100.2

# Network Configuration
network:
  camera_ip: "192.168.100.1"    # Pi 3B+ with camera
  tracker_ip: "192.168.100.2"   # Pi 5 with EV3
  subnet: "24"
  interface: "eth0"

# Camera Server Settings (Pi 3B+)
camera:
  host: "0.0.0.0"
  port: 8000
  recording_dir: "recordings"   # Server-side recording output (used when recording_mode: camera)
  resolution:
    width: 1280
    height: 960

# Tracker Settings (Pi 5)
tracker:
  stream_url: null  # Auto: http://192.168.100.1:8000/stream
  output_dir: "recordings"
  recording_fps: 30  # Fixed output framerate for recordings (stable regardless of processing speed)

  # Recording encoder — controls CPU vs hardware encoding
  #   "auto"            — auto-detect best encoder (recommended)
  #   "h264_v4l2m2m"    — Pi hardware H.264 (near-zero CPU, requires ffmpeg)
  #   "libx264"         — Software H.264 ultrafast (low CPU, requires ffmpeg)
  #   "mjpg"            — Legacy OpenCV MJPG (high CPU, no ffmpeg needed)
  recording_encoder: "auto"

  # Recording mode — where encoding happens
  #   "local"   — record on tracker Pi 5 (default, uses recording_encoder above)
  #   "camera"  — offload to camera Pi 3B+ via HTTP API (zero tracker CPU cost,
  #               uses Pi's hardware H.264 encoder, saves files on the camera Pi)
  recording_mode: "local"

  # Detection settings (Pi 5 can handle higher quality)
  detection:
    interval: 6           # Run detection every N frames
    scale: 0.5            # Frame scale for detection (0.2-1.0)
    confidence: 0.5       # Minimum confidence threshold (0.0-1.0)
    keypoint_threshold: 0.3

  # MoveNet model settings
  movenet:
    model_path: null      # Auto-downloads if null
    threads: 4            # Pi 5 has 4 cores

# EV3 Motor Control Settings
ev3:
  enabled: true
  deadzone:
    x: 90                 # Horizontal deadzone in pixels
    y: 90                 # Vertical deadzone in pixels
  speed_factor: 1.0       # Motor speed multiplier (0.1-2.0)
  max_speed: 50           # Maximum motor speed (1-100)
  invert:
    x: false              # Invert horizontal direction
    y: false              # Invert vertical direction
  cooldown: 0.5           # Command cooldown in seconds
  ports:
    pan: "a"              # Horizontal (pan) motor port
    tilt: "b"             # Vertical (tilt) motor port

# Web Interface Settings
web:
  enabled: true
  host: "0.0.0.0"
  port: 5000

# Performance Presets (used by run scripts)
presets:
  pi3:
    detection_interval: 12
    process_scale: 0.35
    movenet_threads: 2
  pi5:
    detection_interval: 6
    process_scale: 0.5
    movenet_threads: 4

# Logging
logging:
  level: "INFO"           # DEBUG, INFO, WARNING, ERROR
  file: "tracker.log"
  verbose_shifts: false   # Log position shifts to separate file
